/**
 * A simple function to use Emmet in a web environment
 * @property {Boolean} [returnString=false] When set to true the result to the zen function is a string. Default is false.
 * @property {Boolean} [firstChild=false] When set to true the result to the zen function is an HTMLElement when the length of the NodeList is one. Default is false.
 * @param {string} abbreviation The Emmet abbreviation to expand.
 * @param {Object} [content] An optional content object to replace strings from the result.
 * @returns {Array} The Emmet result in an Array.
 * @version 0.1.7
 * @author Ron Valstar <ron@ronvalstar.nl>
 * @licence MIT: http://www.opensource.org/licenses/mit-license.php
 * @requires Emmet (currently using revision ec2136c)
 * @copyright Emmet 2012 Sergey Chikuyonok <serge.che@gmail.com>
 */
var zen=function(){function a(){}var b=function(){var b=this,c=(b._,{}),d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=(d.unshift,e.toString),i=e.hasOwnProperty,j=d.forEach,k=d.map,l=d.reduce,m=(d.reduceRight,d.filter),n=(d.every,d.some,d.indexOf),o=(d.lastIndexOf,Array.isArray),p=Object.keys,q=f.bind,r=a;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=r),exports._=r):b._=r,r.VERSION="1.3.3";var s=r.each=r.forEach=function(a,b,d){if(null!=a)if(j&&a.forEach===j)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(r.has(a,g)&&b.call(d,a[g],g,a)===c)return};r.map=r.collect=function(b,c,d){var e=[];return null==b?e:k&&b.map===k?b.map(c,d):(s(b,a),b.length===+b.length&&(e.length=b.length),e)},r.reduce=r.foldl=r.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),l&&a.reduce===l)return d&&(b=r.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(s(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError("Reduce of empty array with no initial value");return c},r.reduceRight=r.foldr=a,r.find=r.detect=a,r.filter=r.select=function(b,c,d){var e=[];return null==b?e:m&&b.filter===m?b.filter(c,d):(s(b,a),e)},r.reject=a,r.every=r.all=a;var t=r.some=r.any=a;r.include=r.contains=function(b,c){var d=!1;return null==b?d:n&&b.indexOf===n?-1!=b.indexOf(c):d=t(b,a)},r.invoke=a,r.pluck=a,r.max=a,r.min=a,r.shuffle=a,r.sortBy=a,r.groupBy=a,r.sortedIndex=a,r.toArray=a,r.size=a,r.first=r.head=r.take=a,r.initial=a,r.last=a,r.rest=r.tail=function(a,b,c){return g.call(a,null==b||c?1:b)},r.compact=a,r.flatten=function(a,b){return r.reduce(a,function(a,c){return r.isArray(c)?a.concat(b?c:r.flatten(c)):(a[a.length]=c,a)},[])},r.without=a,r.uniq=r.unique=a,r.union=a,r.intersection=r.intersect=a,r.difference=a,r.zip=a,r.indexOf=function(a,b,c){if(null==a)return-1;var d,e;if(c)return d=r.sortedIndex(a,b),a[d]===b?d:-1;if(n&&a.indexOf===n)return a.indexOf(b);for(d=0,e=a.length;e>d;d++)if(d in a&&a[d]===b)return d;return-1},r.lastIndexOf=a,r.range=a,r.bind=function(b){var c,d;if(b.bind===q&&q)return q.apply(b,g.call(arguments,1));if(!r.isFunction(b))throw new TypeError;return d=g.call(arguments,2),c=a},r.bindAll=a,r.memoize=a,r.delay=a,r.defer=a,r.throttle=a,r.debounce=a,r.once=a,r.wrap=a,r.compose=a,r.after=a,r.keys=p||a,r.values=a,r.functions=r.methods=function(a){var b=[];for(var c in a)r.isFunction(a[c])&&b.push(c);return b.sort()},r.extend=function(a){return s(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},r.pick=a,r.defaults=a,r.clone=function(a){return r.isObject(a)?r.isArray(a)?a.slice():r.extend({},a):a},r.tap=a,r.isEqual=a,r.isEmpty=a,r.isElement=a,r.isArray=o||a,r.isObject=function(a){return a===Object(a)},r.isArguments=function(a){return"[object Arguments]"==h.call(a)},r.isArguments(arguments)||(r.isArguments=a),r.isFunction=function(a){return"[object Function]"==h.call(a)},r.isString=function(a){return"[object String]"==h.call(a)},r.isNumber=function(a){return"[object Number]"==h.call(a)},r.isFinite=a,r.isNaN=a,r.isBoolean=a,r.isDate=a,r.isRegExp=a,r.isNull=a,r.isUndefined=function(a){return void 0===a},r.has=function(a,b){return i.call(a,b)},r.noConflict=a,r.identity=a,r.times=a,r.escape=a,r.result=a,r.mixin=function(a){s(r.functions(a),function(b){x(b,r[b]=a[b])})},r.uniqueId=a,r.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var u={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var v in u)u[u[v]]=v;r.template=a,r.chain=a;var w=a;r.prototype=w.prototype;var x=function(b){w.prototype[b]=a};return r.mixin(r),s(["pop","push","reverse","shift","sort","splice","unshift"],function(b){d[b],w.prototype[b]=a}),s(["concat","join","slice"],function(b){d[b],w.prototype[b]=a}),w.prototype.chain=a,w.prototype.value=a,r}.call({}),c=function(c){function d(a){return a in g||!h||h(a),g[a]}var e="html";if("undefined"==typeof b)try{b=c[["require"][0]]("underscore")}catch(f){}if("undefined"==typeof b)throw"Cannot access to Underscore.js lib";var g={_:b},h=null;return{define:function(a,c){a in g||(g[a]=b.isFunction(c)?this.exec(c):c)},require:d,exec:function(a,e){return a.call(e||c,b.bind(d,this),b,this)},extend:a,expandAbbreviation:function(a,b,c,f){if(!a)return"";b=b||e;var g=d("filters"),h=d("abbreviationParser");c=d("profile").get(c,b),d("tabStops").resetTabstopIndex();var i=g.extractFromAbbreviation(a),j=h.parse(i[0],{syntax:b,contextNode:f}),k=g.composeList(b,c,i[1]);return g.apply(j,k,c),j.valueOf()},defaultSyntax:a,defaultProfile:a,log:a,setModuleLoader:a}}(this);"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=c),exports.emmet=c),"undefined"!=typeof define&&define(c),c.define("abbreviationParser",function(b,c){function d(){this.parent=null,this.children=[],this._attributes=[],this.abbreviation="",this.counter=1,this._name=null,this._text="",this.repeatCount=1,this.hasImplicitRepeat=!1,this._data={},this.start="",this.end="",this.content="",this.padding=""}function e(a){return a.substring(1,a.length-1)}function f(a,b){for(var c;c=a.next();)if(c===b)return!0;return!1}function g(a){a=b("utils").trim(a);for(var f,h,i=new d,j=i.addChild(),k=b("stringStream").create(a),l=1e3,m=function(a){j.addChild(a)},o=function(){k.start=k.pos,k.eatWhile(function(a){if("["==a||"{"==a){if(k.skipToPair(a,q[a]))return k.backUp(1),!0;throw'Invalid abbreviation: mo matching "'+q[a]+'" found for character at '+k.pos}if("+"==a){k.next();var b=k.eol()||~"+>^*".indexOf(k.peek());return k.backUp(1),b}return"("!=a&&n(a)})};!k.eol()&&--l>0;)switch(f=k.peek()){case"(":if(k.start=k.pos,!k.skipToPair("(",")"))throw'Invalid abbreviation: mo matching ")" found for character at '+k.pos;var p=g(e(k.current()));(h=k.match(/^\*(\d+)?/,!0))&&j._setRepeat(h[1]),c.each(p.children,m);break;case">":j=j.addChild(),k.next();break;case"+":j=j.parent.addChild(),k.next();break;case"^":var r=j.parent||j;j=(r.parent||r).addChild(),k.next();break;default:o(),j.setAbbreviation(k.current()),k.start=k.pos}if(1>l)throw"Endless loop detected";return i}function h(a){a=b("utils").trim(a);var c=[],d=b("stringStream").create(a);for(d.eatSpace();!d.eol()&&(d.start=d.pos,d.eatWhile(p));){var e=d.current(),g="";if("="==d.peek()){d.next(),d.start=d.pos;var h=d.peek();if('"'==h||"'"==h){if(d.next(),!f(d,h))throw"Invalid attribute value";g=d.current(),g=g.substring(1,g.length-1)}else{if(!d.eatWhile(/[^\s\]]/))throw"Invalid attribute value";g=d.current()}}c.push({name:e,value:g}),d.eatSpace()}return c}function i(a){for(var c=[],d={"#":"id",".":"class"},f=null,g=b("stringStream").create(a);!g.eol();)switch(g.peek()){case"#":case".":null===f&&(f=g.pos);var i=d[g.peek()];g.next(),g.start=g.pos,g.eatWhile(p),c.push({name:i,value:g.current()});break;case"[":if(null===f&&(f=g.pos),g.start=g.pos,!g.skipToPair("[","]"))throw"Invalid attribute set definition";c=c.concat(h(e(g.current())));break;default:g.next()}return c.length?{element:a.substring(0,f),attributes:j(c)}:null}function j(a){a=c.map(a,function(a){return c.clone(a)});var b={};return c.filter(a,function(a){if(!(a.name in b))return b[a.name]=a;var c=b[a.name];return"class"==a.name.toLowerCase()?c.value+=(c.value.length?" ":"")+a.value:c.value=a.value,!1})}function k(a){if(!~a.indexOf("{"))return null;for(var c=b("stringStream").create(a);!c.eol();)switch(c.peek()){case"[":case"(":c.skipToPair(c.peek(),q[c.peek()]);break;case"{":return c.start=c.pos,c.skipToPair("{","}"),{element:a.substring(0,c.start),text:e(c.current())};default:c.next()}}function l(a){for(var b,d,e,f=a.children.length-1;f>=0;f--)if(d=a.children[f],d.isRepeating())for(e=b=d.repeatCount,d.repeatCount=1,d.updateProperty("counter",1),d.updateProperty("maxCount",e);--b>0;)d.parent.addChild(d.clone(),f+1).updateProperty("counter",b+1).updateProperty("maxCount",e);return c.each(a.children,l),a}function m(a){for(var b=a.children.length-1;b>=0;b--){var d=a.children[b];d.isGroup()?d.replace(m(d).children):d.isEmpty()&&d.remove()}return c.each(a.children,m),a}function n(a){var b=a.charCodeAt(0),c="#.*:$-_!@|%";return b>64&&91>b||b>96&&123>b||b>47&&58>b||-1!=c.indexOf(a)}var o=/^[\w\-\$\:@\!%]+\+?$/i,p=/[\w\-:\$@]/,q={"[":"]","(":")","{":"}"},r=Array.prototype.splice,s=[],t=[],u=[];return d.prototype={addChild:function(a,b){return a=a||new d,a.parent=this,c.isUndefined(b)?this.children.push(a):this.children.splice(b,0,a),a},clone:function(){var a=new d,b=["abbreviation","counter","_name","_text","repeatCount","hasImplicitRepeat","start","end","content","padding"];return c.each(b,function(b){a[b]=this[b]},this),a._attributes=c.map(this._attributes,function(a){return c.clone(a)}),a._data=c.clone(this._data),a.children=c.map(this.children,function(b){return b=b.clone(),b.parent=a,b}),a},remove:a,replace:function(){var a=this.parent,b=c.indexOf(a.children,this),d=c.flatten(arguments);r.apply(a.children,[b,1].concat(d)),c.each(d,function(b){b.parent=a})},updateProperty:function(a,b){return this[a]=b,c.each(this.children,function(c){c.updateProperty(a,b)}),this},find:a,findAll:a,data:function(a,c){return 2==arguments.length&&(this._data[a]=c,"resource"==a&&b("elements").is(c,"snippet")&&(this.content=c.data,this._text&&(this.content=b("abbreviationUtils").insertChildContent(c.data,this._text)))),this._data[a]},name:function(){var a=this.matchedResource();return b("elements").is(a,"element")?a.name:this._name},attributeList:function(){var a=[],d=this.matchedResource();return b("elements").is(d,"element")&&c.isArray(d.attributes)&&(a=a.concat(d.attributes)),j(a.concat(this._attributes))},attribute:a,matchedResource:function(){return this.data("resource")},index:a,_setRepeat:function(a){a?this.repeatCount=parseInt(a,10)||1:this.hasImplicitRepeat=!0},setAbbreviation:function(a){a=a||"";var b=this;a=a.replace(/\*(\d+)?$/,function(a,c){return b._setRepeat(c),""}),this.abbreviation=a;var c=k(a);c&&(a=c.element,this.content=this._text=c.text);var d=i(a);if(d&&(a=d.element,this._attributes=d.attributes),this._name=a,this._name&&!o.test(this._name))throw"Invalid abbreviation"},valueOf:function(){var a=b("utils"),d=this.start,e=this.end,f=this.content,g=this;c.each(u,function(a){d=a(d,g,"start"),f=a(f,g,"content"),e=a(e,g,"end")});var h=c.map(this.children,function(a){return a.valueOf()}).join("");return f=b("abbreviationUtils").insertChildContent(f,h,{keepVariable:!1}),d+a.padString(f,this.padding)+e},toString:a,hasEmptyChildren:a,hasImplicitName:a,isGroup:function(){return!this.abbreviation},isEmpty:function(){return!this.abbreviation&&!this.children.length},isRepeating:function(){return this.repeatCount>1||this.hasImplicitRepeat},isTextNode:function(){return!this.name()&&!this.attributeList().length},isElement:a,deepestChild:a},u.push(function(a,c){return b("utils").replaceCounter(a,c.counter,c.maxCount)}),{parse:function(b,d){d=d||{};var e=g(b);return d.contextNode&&(e._name=d.contextNode.name,c.each(e._attributes,a),c.each(d.contextNode.attributes,a)),c.each(s,a),e=m(l(e)),c.each(t,a),e},AbbreviationNode:d,addPreprocessor:a,removeFilter:a,addPostprocessor:a,removePostprocessor:a,addOutputProcessor:function(a){c.include(u,a)||u.push(a)},removeOutputProcessor:a,isAllowedChar:a}}),c.define("utils",function(b,c){return{reTag:/<\/?[\w:\-]+(?:\s+[\w\-:]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*\s*(\/?)>$/,endsWithTag:a,isNumeric:function(a){return"string"==typeof a&&(a=a.charCodeAt(0)),a&&a>47&&58>a},trim:function(a){return(a||"").replace(/^\s+|\s+$/g,"")},getNewline:function(){var a=b("resources");if(!a)return"\n";var d=a.getVariable("newline");return c.isString(d)?d:"\n"},setNewline:a,splitByLines:function(b,d){var e=this.getNewline(),f=(b||"").replace(/\r\n/g,"\n").replace(/\n\r/g,"\n").replace(/\r/g,"\n").replace(/\n/g,e).split(e);return d&&(f=c.filter(f,a,this)),f},normalizeNewline:a,repeatString:a,getStringsPads:a,padString:function(a,d){var e=c.isNumber(d)?this.repeatString(b("resources").getVariable("indentation")||"	",d):d,f=[],g=this.splitByLines(a),h=this.getNewline();f.push(g[0]);for(var i=1;i<g.length;i++)f.push(h+e+g[i]);return f.join("")},zeroPadString:function(a,b){for(var c="",d=a.length;b>d++;)c+="0";return c+a},unindentString:a,replaceUnescapedSymbol:function(a,b,d){for(var e=0,f=a.length,g=b.length,h=0;f>e;)if("\\"==a.charAt(e))e+=g+1;else if(a.substr(e,g)==b){var i=g;h++;var j=d;if(c.isFunction(d)){var k=d(a,b,e,h);k?(i=k[0].length,j=k[1]):j=!1}if(j===!1){e++;continue}a=a.substring(0,e)+j+a.substring(e+i),f=a.length,e+=j.length}else e++;return a},replaceVariables:function(d,e){return e=e||{},c.isFunction(e)?e:a,b("resources"),b("tabStops").processText(d,{variable:a})},replaceCounter:function(a,b,d){var e="$";a=String(a),b=String(b),/^\-?\d+$/.test(b)&&(b=+b);var f=this;return this.replaceUnescapedSymbol(a,e,function(a,e,g){if("{"==a.charAt(g+1)||f.isNumeric(a.charAt(g+1)))return!1;for(var h=g+1;"$"==a.charAt(h)&&"{"!=a.charAt(h+1);)h++;var i,j=h-g,k=0,l=!1;return(i=a.substr(h).match(/^@(\-?)(\d*)/))&&(h+=i[0].length,i[1]&&(l=!0),k=parseInt(i[2]||1,10)-1),l&&d&&c.isNumber(b)&&(b=d-b+1),b+=k,[a.substring(g,h),f.zeroPadString(b+"",j)]})},matchesTag:a,escapeText:a,unescapeText:a,getCaretPlaceholder:a,setCaretPlaceholder:a,getLinePadding:a,getLinePaddingFromPosition:a,escapeForRegexp:a,prettifyNumber:a,replaceSubstring:function(a,b,d,e){return c.isObject(d)&&"end"in d&&(e=d.end,d=d.start),c.isString(e)&&(e=d+e.length),c.isUndefined(e)&&(e=d),0>d||d>a.length?a:a.substring(0,d)+b+a.substring(e)},narrowToNonSpace:a,findNewlineBounds:a,deepMerge:function(){var a,b,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length;for(c.isObject(h)||c.isFunction(h)||(h={});j>i;i++)if(null!==(a=arguments[i]))for(b in a)d=h[b],e=a[b],h!==e&&(e&&(c.isObject(e)||(f=c.isArray(e)))?(f?(f=!1,g=d&&c.isArray(d)?d:[]):g=d&&c.isObject(d)?d:{},h[b]=this.deepMerge(g,e)):void 0!==e&&(h[b]=e));return h}}}),c.define("handlerList",function(){function b(){this._list=[]}return b.prototype={add:a,remove:a,list:a,listFn:a,exec:a},{create:function(){return new b}}}),c.define("stringStream",function(){function b(a){this.pos=this.start=0,this.string=a}return b.prototype={eol:function(){return this.pos>=this.string.length},sol:a,peek:function(){return this.string.charAt(this.pos)},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(a){var b,c=this.string.charAt(this.pos);return b="string"==typeof a?c==a:c&&(a.test?a.test(c):a(c)),b?(++this.pos,c):void 0},eatWhile:function(a){for(var b=this.pos;this.eat(a););return this.pos>b},eatSpace:function(){for(var a=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>a},skipToEnd:a,skipTo:a,skipToPair:function(a,b){for(var c,d=0,e=this.pos,f=this.string.length;f>e;)if(c=this.string.charAt(e++),c==a)d++;else if(c==b&&(d--,1>d))return this.pos=e,!0;return!1},backUp:function(a){this.pos-=a},match:function(b,c,d){if("string"!=typeof b){var e=this.string.slice(this.pos).match(b);return e&&c!==!1&&(this.pos+=e[0].length),e}var f=d?a:a;return f(this.string).indexOf(f(b),this.pos)==this.pos?(c!==!1&&(this.pos+=b.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},{create:function(a){return new b(a)}}}),c.define("resources",function(b,c){var d={},e={},f={};return b("handlerList").create(),{setVocabulary:a,getVocabulary:a,getMatchedResource:a,getVariable:function(a){return(this.getSection("variables")||{})[a]},setVariable:a,hasSyntax:a,addResolver:a,removeResolver:a,getSection:function(a){if(!a)return null;a in d||(d[a]=b("utils").deepMerge({},e[a],f[a]));for(var g,h=d[a],i=c.rest(arguments);h&&(g=i.shift());){if(!(g in h))return null;h=h[g]}return h},findItem:function(a,b){for(var c=this.getSection(a);c;){if(b in c)return c[b];c=this.getSection(c["extends"])}},findSnippet:a,fuzzyFindSnippet:a,getAllSnippets:a}}),c.define("profile",function(b,c){function d(a){c.extend(this,i,a)}function e(a,b){switch(String(b||"").toLowerCase()){case"lower":return a.toLowerCase();case"upper":return a.toUpperCase()}return a}function f(a,b){return h[a.toLowerCase()]=new d(b)}function g(){f("xhtml"),f("html",{self_closing_tag:!1}),f("xml",{self_closing_tag:!0,tag_nl:!0}),f("plain",{tag_nl:!1,indent:!1,place_cursor:!1}),f("line",{tag_nl:!1,indent:!1,extraFilters:"s"})}var h={},i={tag_case:"asis",attr_case:"asis",attr_quotes:"double",tag_nl:"decide",tag_nl_leaf:!1,place_cursor:!0,indent:!0,inline_break:3,self_closing_tag:"xhtml",filters:"",extraFilters:""};return d.prototype={tagName:function(a){return e(a,this.tag_case)},attributeName:function(a){return e(a,this.attr_case)},attributeQuote:function(){return"single"==this.attr_quotes?"'":'"'},selfClosing:a,cursor:function(){return this.place_cursor?b("utils").getCaretPlaceholder():""}},g(),{create:a,get:function(a,e){if(!a&&e){var f=b("resources").findItem(e,"profile");f&&(a=f)}return a?a instanceof d?a:c.isString(a)&&a.toLowerCase()in h?h[a.toLowerCase()]:this.create(a):h.plain},remove:a,reset:a,stringCase:e}}),c.define("abbreviationUtils",function(b,c){return{isUnary:function(a){if(a.children.length||a._text||this.isSnippet(a))return!1;var b=a.matchedResource();return b&&b.is_empty},isInline:a,isBlock:a,isSnippet:function(a){return b("elements").is(a.matchedResource(),"snippet")},hasTagsInContent:a,hasBlockChildren:a,insertChildContent:function(d,e,f){f=c.extend({keepVariable:!0,appendIfNoChild:!0},f||{});var g=!1,h=b("utils");return d=h.replaceVariables(d,a),!g&&f.appendIfNoChild&&(d+=e),d}}}),c.define("htmlMatcher",function(){return{find:a,tag:a}}),c.define("tabStops",function(b,c){var d=100,e=0,f={replaceCarets:!1,escape:a,tabstop:a,variable:a};return b("abbreviationParser").addOutputProcessor(function(c,d){var f=0,g=b("tabStops"),h=b("utils"),i={tabstop:a};return c=g.processText(c,i),c=h.replaceVariables(c,g.variablesResolver(d)),e+=f+1,c}),{extract:a,processText:function(a,d){d=c.extend({},f,d);for(var e,g,h,i="",j=b("stringStream").create(a);e=j.next();)if("\\"!=e||j.eol()){if(h=e,"$"==e)if(j.start=j.pos-1,g=j.match(/^[0-9]+/))h=d.tabstop({start:i.length,group:j.current().substr(1),token:j.current()});else if(g=j.match(/^\{([a-z_\-][\w\-]*)\}/))h=d.variable({start:i.length,name:g[1],token:j.current()});else if(g=j.match(/^\{([0-9]+)(:.+?)?\}/,!1)){j.skipToPair("{","}");var k={start:i.length,group:g[1],token:j.current()},l=k.token.substring(k.group.length+2,k.token.length-1);l&&(k.placeholder=l.substr(1)),h=d.tabstop(k)}i+=h}else i+=d.escape(j.next());return i},upgrade:a,variablesResolver:function(){return b("resources"),a},resetTabstopIndex:function(){e=0,d=100}}}),c.define("preferences",function(b,c){function d(a){return c.isObject(a)&&"value"in a&&c.keys(a).length<3}var e={},f={};return{define:function(a,b,e){var g=a;c.isString(a)&&(g={},g[a]={value:b,description:e}),c.each(g,function(a,b){f[b]=d(a)?a:{value:a}})},set:a,get:function(a){return a in e?e[a]:a in f?f[a].value:void 0},getArray:function(a){var d=this.get(a);return c.isUndefined(d)||null===d||""===d?null:(d=c.map(d.split(","),b("utils").trim),d.length?d:null)},getDict:a,description:a,remove:a,list:a,load:a,exportModified:a,reset:a,_startTest:a,_stopTest:a}}),c.define("elements",function(){function b(){}var c={},d={add:function(b){c[b]=a},get:a,create:a,is:function(a,b){return a&&a.type===b}};return d.add("element",a),d.add("snippet",b),d.add("reference",b),d.add("empty",a),d}),c.define("filters",function(b,c){function d(a){return a?c.isString(a)?a.split(/[\|,]/g):a:[]}var e={},f="html";return{add:function(a,b){e[a]=b},apply:function(a,f,g){var h=b("utils");return g=b("profile").get(g),c.each(d(f),function(b){var c=h.trim(b.toLowerCase());c&&c in e&&(a=e[c](a,g))}),a},composeList:function(a,c,e){c=b("profile").get(c);var g=d(c.filters||b("resources").findItem(a,"filters")||f);return c.extraFilters&&(g=g.concat(d(c.extraFilters))),e&&(g=g.concat(d(e))),g&&g.length||(g=d(f)),g},extractFromAbbreviation:function(b){var c="";return b=b.replace(/\|([\w\|\-]+)$/,a),[b,d(c)]}}}),c.exec(function(a,b){function c(c){return b.include(l.getArray("format.noIndentTags")||[],c.name())?"":a("resources").getVariable("indentation")}function d(){}function e(){}function f(){}function g(){}function h(){}function i(){}function j(h,j){h.start=h.end=k;var m=a("utils"),n=a("abbreviationUtils"),o=n.isUnary(h),p=m.getNewline(),q=c(h);if(j.tag_nl!==!1){var r=j.tag_nl===!0&&(j.tag_nl_leaf||h.children.length);r||(r=b.include(l.getArray("format.forceIndentationForTags")||[],h.name())),h.isTextNode()||(f(h,j)?(e(h)||n.isSnippet(h.parent)&&!h.index()||(h.start=p+h.start),(n.hasBlockChildren(h)||g(h,j)||r&&!o)&&(h.end=p+h.end),(n.hasTagsInContent(h)||r&&!h.children.length&&!o)&&(h.start+=p+q)):n.isInline(h)&&d(h)&&!e(h)?h.start=p+h.start:n.isInline(h)&&i(h,j)&&(h.end=p+h.end),h.padding=q)}return h}var k="%s",l=a("preferences");l.define("format.noIndentTags","html","A comma-separated list of tag names that should not get inner indentation."),l.define("format.forceIndentationForTags","body","A comma-separated list of tag names that should <em>always</em> get inner indentation."),a("filters").add("_format",function m(c,d,e){e=e||0;var f=a("abbreviationUtils");return b.each(c.children,function(a){f.isSnippet(a)?h(a,d,e):j(a,d,e),m(a,d,e+1)}),c})}),c.exec(function(a,b){function c(a,c){var d=c.attributeQuote(),e=c.cursor();return b.map(a.attributeList(),function(a){var b=c.attributeName(a.name);return" "+b+"="+d+(a.value||e)+d}).join("")}function d(b,d){if(!b.parent)return b;var e=a("abbreviationUtils"),f=a("utils"),g=c(b,d),h=d.cursor(),i=e.isUnary(b),j="",k="";if(!b.isTextNode()){var l=d.tagName(b.name());i?(j="<"+l+g+d.selfClosing()+">",b.end=""):(j="<"+l+g+">",k="</"+l+">")}var m="%s";return b.start=f.replaceSubstring(b.start,j,b.start.indexOf(m),m),b.end=f.replaceSubstring(b.end,k,b.end.indexOf(m),m),b.children.length||i||~b.content.indexOf(h)||a("tabStops").extract(b.content).tabstops.length||(b.start+=h),b}a("filters").add("html",function e(c,f,g){g=g||0;var h=a("abbreviationUtils");return g||(c=a("filters").apply(c,"_format",f)),b.each(c.children,function(a){h.isSnippet(a)||d(a,f,g),e(a,f,g+1)}),c})});var d=function(a){"use strict";var b=document.createElement("div"),c=b.childNodes,d=function(e,f,g){var h,i,j=[],k=a.expandAbbreviation(e);if(void 0!==f)for(var l in f){var m=f[l];if(m instanceof Array)for(h=m.length;h>=0;h--)k=k.replace(new RegExp(l+(h+1),"g"),m[h]);else k=k.replace(new RegExp(l,"g"),m)}if(d.returnString||g)j=k,console.log("returnString",k);else if(b.innerHTML=k,i=c.length,d.firstChild&&1===i)j=b.firstChild;else for(h=0;i>h;h++)j.push(c[h]);return j};return d.returnString=!1,d.firstChild=!1,d.exposeEmmet=function(){return a},d}(c);return d}();